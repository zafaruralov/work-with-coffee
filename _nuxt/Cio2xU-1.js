import{d as ae,r as b,k as q,a5 as Q,o as se,a4 as re,x as u,z as a,Y as f,a3 as ne,T as o,Z as v,R as D,a0 as ie,W,X,A as w,a8 as ue,$,K as de,ac as ce,ad as pe,a2 as Y,y as r,D as T}from"./C_9rOkkL.js";const fe=["aria-expanded"],ve={class:"flex-1 flex flex-wrap gap-1 min-h-[24px]"},ye=["onClick","aria-label"],me={class:"text-gray-900"},ge=["placeholder"],he={key:0,class:"ml-2"},be={class:"ml-2"},we={key:0,class:"mt-1 text-sm text-red-600"},ke=["aria-multiselectable"],Ce=["onClick","onMouseenter","aria-selected"],xe={class:"flex items-center justify-between"},Le={key:0,class:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},De={key:2,class:"px-3 py-2 text-gray-500 text-center flex items-center justify-center gap-2"},Ve=ae({__name:"DynamicSelector",props:{modelValue:{},options:{},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},placeholder:{default:"Select an option..."},searchPlaceholder:{default:"Search..."},displayKey:{type:Function,default:"label"},valueKey:{type:Function,default:"value"},searchable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},creatable:{type:Boolean,default:!1},error:{},customClasses:{},loadOptions:{},debounceMs:{default:300}},emits:["update:modelValue","search","create","open","close"],setup(Z,{emit:G}){const t=Z,y=G,d=b(!1),n=b(""),i=b(-1),B=b(),V=b(),K=b(),R=b({}),c=q(()=>t.modelValue?Array.isArray(t.modelValue)?t.modelValue:[t.modelValue]:[]),m=q(()=>{if(!t.options)return[];if(!n.value)return t.options;const e=n.value.toLowerCase();return t.options.filter(l=>k(l).toLowerCase().includes(e))}),k=e=>typeof t.displayKey=="function"?t.displayKey(e):String(e[t.displayKey]||e),g=e=>typeof t.valueKey=="function"?t.valueKey(e):e[t.valueKey]||e,H=e=>String(g(e)),M=e=>c.value.some(l=>g(l)===g(e)),E=e=>{if(t.multiple){const l=c.value,h=M(e);let p;h?p=l.filter(x=>g(x)!==g(e)):p=[...l,e],y("update:modelValue",p)}else y("update:modelValue",e),S()},N=e=>{if(t.multiple){const l=c.value.filter(h=>g(h)!==g(e));y("update:modelValue",l)}},J=()=>{y("update:modelValue",t.multiple?[]:null)},U=()=>{y("create",n.value),n.value=""},_=()=>{t.disabled||(d.value?S():O())},O=()=>{t.disabled||(d.value=!0,i.value=-1,Y(()=>{C(),t.searchable&&K.value&&K.value.focus()}),y("open"))},S=()=>{d.value=!1,n.value="",i.value=-1,y("close")},C=()=>{if(!B.value||!V.value)return;const e=B.value.getBoundingClientRect(),l=V.value.offsetHeight,p=window.innerHeight-e.bottom,x=e.top,z=p<l&&x>p;R.value={position:"fixed",left:`${e.left}px`,width:`${e.width}px`,top:z?`${e.top-l}px`:`${e.bottom}px`,zIndex:9999}},ee=e=>{if(!t.disabled)switch(e.key){case"Enter":case" ":e.preventDefault(),d.value?i.value>=0&&E(m.value[i.value]):O();break;case"Escape":e.preventDefault(),S();break;case"ArrowDown":e.preventDefault(),d.value?i.value=Math.min(i.value+1,m.value.length-1):O();break;case"ArrowUp":e.preventDefault(),d.value&&(i.value=Math.max(i.value-1,-1));break}},le=e=>{switch(e.key){case"Enter":e.preventDefault(),i.value>=0?E(m.value[i.value]):t.creatable&&n.value&&U();break;case"Escape":e.preventDefault(),S();break;case"ArrowDown":e.preventDefault(),i.value=Math.min(i.value+1,m.value.length-1);break;case"ArrowUp":e.preventDefault(),i.value=Math.max(i.value-1,-1);break}};let A;const te=e=>{clearTimeout(A),A=setTimeout(()=>{y("search",e),t.loadOptions&&t.loadOptions(e)},t.debounceMs)};Q(n,e=>{te(e)});const F=e=>{d.value&&B.value&&V.value&&!B.value.contains(e.target)&&!V.value.contains(e.target)&&S()};return se(()=>{document.addEventListener("click",F),window.addEventListener("resize",C),window.addEventListener("scroll",C)}),re(()=>{document.removeEventListener("click",F),window.removeEventListener("resize",C),window.removeEventListener("scroll",C),clearTimeout(A)}),Q(d,e=>{e&&Y(C)}),(e,l)=>{var h,p,x,z,P,j;return r(),u("div",{class:"relative w-full",ref_key:"selectorRef",ref:B},[a("div",{class:v(["relative flex items-center min-h-[2.5rem] px-3 py-2 border rounded-lg cursor-pointer transition-all duration-200","focus-within:ring-2 focus-within:ring-[#a65330] focus-within:border-[#a65330]",e.disabled?"bg-gray-100 cursor-not-allowed opacity-60":"bg-white hover:border-gray-400",e.error?"border-red-500":"border-gray-300",((h=e.customClasses)==null?void 0:h.container)||""]),onClick:_,onKeydown:ee,tabindex:"0","aria-expanded":o(d),"aria-haspopup":!0,role:"combobox"},[a("div",ve,[e.multiple&&o(c).length>0?(r(!0),u(W,{key:0},X(o(c),s=>{var L;return r(),u("div",{key:H(s),class:v(["inline-flex items-center gap-1 px-2 py-1 text-sm rounded-md","bg-blue-100 text-blue-800 border border-blue-200",((L=e.customClasses)==null?void 0:L.tag)||""])},[D(e.$slots,"tag",{item:s,remove:()=>N(s)},()=>[a("span",null,w(k(s)),1),a("button",{onClick:$(I=>N(s),["stop"]),class:"ml-1 hover:bg-blue-200 rounded-full p-0.5 transition-colors","aria-label":`Remove ${k(s)}`},l[2]||(l[2]=[a("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,ye)])],2)}),128)):!e.multiple&&o(c).length>0?D(e.$slots,"selected",{key:1,item:o(c)[0]},()=>[a("span",me,w(k(o(c)[0])),1)]):(r(),u("span",{key:2,class:v(["text-gray-500",((p=e.customClasses)==null?void 0:p.placeholder)||""])},w(e.placeholder),3)),e.searchable&&o(d)?ie((r(),u("input",{key:3,ref_key:"searchInput",ref:K,"onUpdate:modelValue":l[0]||(l[0]=s=>de(n)?n.value=s:null),class:v(["flex-1 min-w-[100px] outline-none bg-transparent",((x=e.customClasses)==null?void 0:x.searchInput)||""]),placeholder:e.searchPlaceholder,onClick:l[1]||(l[1]=$(()=>{},["stop"])),onKeydown:$(le,["stop"])},null,42,ge)),[[ue,o(n)]]):f("",!0)]),e.loading?(r(),u("div",he,l[3]||(l[3]=[a("svg",{class:"animate-spin h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):f("",!0),e.clearable&&o(c).length>0&&!e.disabled?(r(),u("button",{key:1,onClick:$(J,["stop"]),class:"ml-2 p-1 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Clear selection"},l[4]||(l[4]=[a("svg",{class:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))):f("",!0),a("div",be,[(r(),u("svg",{class:v(["w-4 h-4 text-gray-400 transition-transform duration-200",o(d)?"rotate-180":""]),fill:"currentColor",viewBox:"0 0 20 20"},l[5]||(l[5]=[a("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])],42,fe),e.error?(r(),u("p",we,w(e.error),1)):f("",!0),(r(),ne(pe,{to:"body"},[o(d)?(r(),u("div",{key:0,ref_key:"dropdownRef",ref:V,class:v(["absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",((z=e.customClasses)==null?void 0:z.dropdown)||""]),style:ce(o(R)),role:"listbox","aria-multiselectable":e.multiple},[e.creatable&&o(n)&&!o(m).some(s=>k(s).toLowerCase()===o(n).toLowerCase())?(r(),u("div",{key:0,class:v(["px-3 py-2 cursor-pointer hover:bg-gray-50 border-b border-gray-100","text-blue-600 font-medium",((P=e.customClasses)==null?void 0:P.createOption)||""]),onClick:U,role:"option"},[D(e.$slots,"create",{query:o(n)},()=>[T(' Create "'+w(o(n))+'" ',1)])],2)):f("",!0),(r(!0),u(W,null,X(o(m),(s,L)=>{var I;return r(),u("div",{key:H(s),class:v(["px-3 py-2 cursor-pointer transition-colors duration-150","hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",M(s)?"bg-blue-50 text-blue-700":"text-gray-900",o(i)===L?"bg-gray-100":"",((I=e.customClasses)==null?void 0:I.option)||""]),onClick:oe=>E(s),onMouseenter:oe=>i.value=L,role:"option","aria-selected":M(s),tabindex:"-1"},[D(e.$slots,"option",{option:s,selected:M(s),index:L},()=>[a("div",xe,[a("span",null,w(k(s)),1),M(s)?(r(),u("svg",Le,l[6]||(l[6]=[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))):f("",!0)])])],42,Ce)}),128)),o(m).length===0&&!e.loading?(r(),u("div",{key:1,class:v(["px-3 py-2 text-gray-500 text-center",((j=e.customClasses)==null?void 0:j.noOptions)||""])},[D(e.$slots,"no-options",{query:o(n)},()=>[T(w(o(n)?"No options found":"No options available"),1)])],2)):f("",!0),e.loading?(r(),u("div",De,[l[8]||(l[8]=a("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),D(e.$slots,"loading",{},()=>[l[7]||(l[7]=T("Loading..."))])])):f("",!0)],14,ke)):f("",!0)]))],512)}}});export{Ve as _};
